function [y1] = NNController(x1)
%NNCONTROLLER neural network simulation function.
%
% Auto-generated by MATLAB, 29-Apr-2025 12:36:15.
% 
% [y1] = NNController(x1) takes these arguments:
%   x = 3xQ matrix, input #1
% and returns:
%   y = 1xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-0.999999230697499;-0.906643605519713;-0.909086721508972];
x1_step1.gain = [1.00000054318563;1.06445749473044;1.01010543946487];
x1_step1.ymin = -1;

% Layer 1
b1 = [-5.2412024743942664529;6.6054873185104723277;-5.7112423893481745196;-2.2834958939530940469;1.716437384442011771;-2.3536675782285350067;-0.10660065205987882819;2.8922336396165726491;3.7310655802402541426;3.9733303330938869458];
IW1_1 = [1.7495233306330923995 -6.2468017030399485279 -2.2303550451410942834;-1.9585361279661941403 -2.7094240772270299367 3.6813505330669062943;5.6077838381941580437 -0.12325342167568958951 -1.8762299326649305442;0.30222884530698651551 -5.763113740436046406 -7.6802202705787001591;0.34789455719925604926 4.7550404652320166221 8.2990289724277488403;4.0621116862372348422 -1.7361067163574275263 3.0092625079731560866;5.5994842079463129636 -4.9391378483737753413 -2.1067132142436020281;-0.026073495130744622078 -4.6807127422784855497 -4.4117828814696631312;1.4701006907334506213 -4.0842339461096353048 -4.3321044172384555182;3.3088977356888760184 -2.9019868342762169533 -5.0760118486954537431];

% Layer 2
b2 = [-0.042054756235223082761;0.1637579873664391783;-1.3766639998832514991;1.4082274995340482437;-0.65417501379480103019;-1.6189038191619113949;-1.0751520561882199623;-0.32138201603537575046;-0.50293665868867554192;-0.40020073430956804028];
LW2_1 = [0.80112126085930446262 -1.2492073311180988959 2.3705715461941938571 -0.25150250031487880742 -0.35890694401770295574 -0.60242108110787551123 -1.8670577666711858367 0.09666500505860353698 0.37734020255946243427 -0.45711440475827652685;-1.1659056541439583032 -0.63278928665254985386 -0.5836165725233863899 0.092248407900518594738 -0.076916148383370214203 0.5719884134836247247 0.70955349683575918984 -0.33895785942684353298 0.45282012041954028403 -0.46902478628349186796;-0.063750829313209411708 0.17124217236926253527 0.9499257589209708641 2.8596401184206050594 2.1928380512610421427 -0.073062574391639517613 -0.28629709676728981593 -0.88606056641241948135 0.77667919661885931326 0.46486028203528734215;0.84310912806203130998 -2.2529135427570374794 0.19941392129147572643 1.3009121100806184668 1.4076076109335844411 0.19986925294723084656 -1.5038337365224998532 -0.90452515173009873095 0.900543131314187284 0.42388964295088477074;-0.41911351029029325632 1.5702731705087187297 -1.8372643359867124602 -3.4453128162045616456 -1.2024745838612407312 0.69395615782811825856 2.1158870501041202594 -0.93305653711266045569 0.80566238338303541866 -0.89332161592441516884;-0.94424507108638844333 0.22712258223415521252 -0.073736661955550675263 0.3109913746745672225 2.1054754011722796037 -0.042457160013904288176 -0.33192964427041410369 -1.2310566839707839382 -0.12957500391813256413 -0.29303235835294461076;-0.43999121380441641449 -0.48235619151147313133 -0.76284845813807533599 -1.0935223483667038114 0.95380200684982097137 -0.41687888995150063076 2.0710987024716938087 0.3744837027123376072 0.60167528077069065695 0.10257800570869525514;-0.14943703284137102583 0.11077037232398005695 -0.69802403458927875235 -0.69955551471795041074 -1.281265328714742191 0.55194398413358358724 0.87551779866283474529 0.45772204274793826251 1.1542652040956355997 -0.20633726176863359525;-0.327390604291916687 -1.3944278488239787439 1.4632707686812520542 0.96934702248150150794 2.0721841962403297899 0.93369195289665396498 -0.80403324213354887551 1.256633935593855389 -0.43567501240666561824 0.38569004548803309529;-0.56738186654134104003 0.61102186314678863521 0.9068040049691533655 -0.73655251616563577333 -0.76519812795325437005 0.27061223691502322986 1.4529979609846970234 -0.86523505409878664896 -1.2167173709786318625 0.054101876941466495174];

% Layer 3
b3 = [-1.7649287159596191987;-1.3710121438865161547;0.96548309774754581536;-0.56058016668326193788;0.26954939200279109945;-0.040663794653584821315;0.49032389012828364594;1.0646829679312597161;-1.3411167403515384944;2.6398974290954142496];
LW3_2 = [0.90334387472690003129 -0.38767104788517203762 -0.92371219333908061166 0.28700900698240278119 -0.49087041461408098542 0.80223086970713441968 -0.14894577292308219807 0.062229826321623903096 0.55264996942390542944 0.0501748171462683204;0.81995829247796314654 0.39305795847259766829 0.12025000355425159715 -0.24107753861550090813 -0.40645538885317261668 0.74347515690556287282 -0.79181693607601211227 0.30102973978713970515 -0.15056093403786477425 0.86724129550582274018;-1.3931147115538171644 0.66493176069689829966 1.7828443781028204818 0.37230013416236273915 0.054828818958090184965 1.7350992949801415932 -0.071188699007140032737 -0.61475670780427560391 -0.60872364819497726263 0.074062780058513411063;0.81942016240222503853 -0.050359646805842504802 0.071919312434914464682 -0.024432986450114265592 -0.281577409184283034 -0.68572522998277274375 0.24415253322723406981 0.62120099689812047217 -0.56134172447756724988 0.93489186753609154756;-0.64655243937276396515 -0.12785666879778034843 -1.4744039323307909228 -0.40431586806902120035 0.36694879729110024824 -0.70381262057758753325 -0.77213860617936314057 0.47483157704134310029 -2.1849005569464576837 -0.73131646595601795813;-1.3316515920271061457 0.09147941188344864416 -2.2821607064784390495 -3.1685799456869152557 4.2860588861785746673 -1.1575381243516276175 1.0121262649454367821 1.5340597140947171972 -2.2254827267135302016 1.6401228165862742348;0.16738292793160367 -1.4201882299974952772 -0.39643336038735127458 0.29106764988820482687 1.538852802988695645 -0.18425947846882562153 0.8508484495929217184 0.0083132514861141582757 -0.56331059121734805561 -0.73675619720270946189;0.92438266572488803074 -1.6020227002118985205 1.0457792700142678477 -1.3607764838027631704 -1.5607115176319783512 -0.105560546404127098 -1.6230469364187649628 -1.1768374304750299775 0.69647908857729146082 0.95662261146578964066;-0.51861692693495220485 0.98028779119731768166 -0.46496052394621201209 -0.38479154764681317014 0.19282620486770016277 -0.64329443707967381982 -0.8008731619831493953 -0.67568619490755055246 -0.27306897258856793753 0.35760620949365717891;1.0439158861300490422 0.89172307454216481748 -1.7527639441754241378 2.1032730190142410187 -0.48232071635397211207 -1.3820939814305455151 -2.1464266761608321588 0.032989766388453176105 -0.55216185420439067855 -0.17840488690160624663];

% Layer 4
b4 = 1.1729456290400397389;
LW4_3 = [-0.82930471355024681923 -0.89320135870383488008 0.46214173818285098072 0.40108581198715320681 -1.3076277168887360247 4.0221078051593055491 -1.3838085696133208824 -1.0115153210114755655 -0.38386986843602260988 0.89827590231567122636];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.542421086464408;
y1_step1.xoffset = -1.01425713965431;

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = logsig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = repmat(b2,1,Q) + LW2_1*a1;

% Layer 3
a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);

% Layer 4
a4 = repmat(b4,1,Q) + LW4_3*a3;

% Output 1
y1 = mapminmax_reverse(a4,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Positive Transfer Function
function a = logsig_apply(n,~)
  a = 1 ./ (1 + exp(-n));
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
